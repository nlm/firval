
ports:
  http: 80
  https: 443
  simple: 100
  comma: 200,201,302
  range: 1025-65535
  revrange: 1000-500
  mulrange: 10-19,20-29
  mixed: 300,401-420

parameters:
  auto_accept_ping: true
  auto_accept_established: true
  auto_accept_lo: true
  auto_drop_invalid: true
  auto_clamp_mss: true
  reject_with: 'icmp-host-prohibited'
  log: 'nflog'

addresses:
  host1: '1.1.1.1'
  host2: '2.2.2.2'
  host3: '3.3.3.3'
  net1: '1.1.1.1/24'
  net2: '2.2.2.2/24'
  net3: '3.3.3.3/24'

zones:
  mgt:
    # optional: list or scalar = antispoof
    # not recommended for public interfaces
    - eth0: '192.168.2.0/24'
  sup:
    - eth1
  pub:
    - eth2
    - eth3

services:
  http:
    proto: 'tcp'
    port: 80
  dns:
    proto: 'udp'
    port: 53
  ping:
    proto: 'icmp'
    type: 'echo-request'
  ssh:
    proto: 'tcp'
    port: 22
  rsh:
    proto: 'tcp'
    port: 22,23
  http:
    proto: 'tcp'
    port: 80
  https:
    proto: tcp
    port: 443
  simple:
    proto: tcp
    port: 100
  comma:
    proto: tcp
    port: 200,201,302
  range:
    proto: tcp
    port: 1025-65535
  revrange:
    proto: tcp
    port: 1000-500
  mulrange:
    proto: tcp
    port: 10-19,20-29
  mixed:
    proto: tcp
    port: 300,401-420


chains:
  filter:
    testports:
      - 'accept to any port comma proto tcp'
      - 'accept to any port http,https proto tcp'
      - 'accept to any port simple,comma,range,revrange,mulrange,mixed proto tcp'
      - 'accept service simple,comma,range,revrange,mulrange,mixed'
    testlog:
      - 'log prefix "coucou"'
      - 'log_drop'
    test1:
      - 'accept from net1 to any service http'
      - 'accept from host1,host2 to net1,net2 service http,ssh'
      - 'accept from net3 service rsh'

rules:
  # syntax is table_chain
  # if table is omitted: filter
  filter input:
    from mgt:
      # accept state established (free)
      - 'accept service ssh'
      - 'log_reject'
    #to mgt:
    #  - 'accept'
  filter forward:
    # creates chain forward-mgt-to-sup
    from mgt to sup:
      # accept state established
      # clampmss
      - 'accept'
    from mgt to pub:
      - 'accept'
      - 'log prefix "coucou"'
    from pub to mgt:
      - 'accept state established'
      - 'jump test1'
    default:
      # accept state established
      # clampmss
      - 'reject'
      #- 'log, reject'
  nat postrouting:
    to pub:
      - 'masquerade from net2'
