
#ports:
#  http: 80
#  https: 443

parameters:
  accept_ping: true
  accept_established: true
  clamp_mss: true
  reject_with: 'icmp-host-prohibited'
  auto_lo: true
  log: 'nflog'

addresses:
  host1: '1.1.1.1'
  host2: '2.2.2.2'
  host3: '3.3.3.3'
  net1: '1.1.1.1/24'
  net2: '2.2.2.2/24'
  net3: '3.3.3.3/24'

zones:
  mgt:
    # optional: list or scalar = antispoof
    # not recommended for public interfaces
    - eth0: '192.168.2.0/24'
  sup:
    - eth1
  pub:
    - eth2
    - eth3

services:
  http:
      proto: 'tcp'
      port: 80
  dns_udp:
      proto: 'udp'
      port: 53
  ping:
      proto: 'icmp'
      type: 'echo-request'

rules:
  # syntax is table_chain
  # if table is omitted: filter
  filter input:
    from mgt:
      # accept state established (free)
      - 'accept service ssh'
      #- 'reject log (prefix=XXX)'
  filter forward:
    # creates chain forward-mgt-to-sup
    from mgt to sup:
      # accept state established
      # clampmss
      - 'accept'
    from mgt to pub:
      - 'accept'
    from pub to mgt:
      - 'accept state established'
    default:
      # accept state established
      # clampmss
      - 'reject'
      #- 'log, reject'
  nat postrouting:
    to pub:
      - 'masquerade from net2'
