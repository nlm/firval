
#ports:
#  http: 80
#  https: 443

parameters:
  auto_accept_ping: true
  auto_accept_established: true
  auto_accept_lo: true
  auto_clamp_mss: true
  reject_with: 'icmp-host-prohibited'
  log: 'nflog'

addresses:
  host1: '1.1.1.1'
  host2: '2.2.2.2'
  host3: '3.3.3.3'
  net1: '1.1.1.1/24'
  net2: '2.2.2.2/24'
  net3: '3.3.3.3/24'

zones:
  mgt:
    # optional: list or scalar = antispoof
    # not recommended for public interfaces
    - eth0: '192.168.2.0/24'
  sup:
    - eth1
  pub:
    - eth2
    - eth3

services:
  http:
    proto: 'tcp'
    port: 80
  dns:
    proto: 'udp'
    port: 53
  ping:
    proto: 'icmp'
    type: 'echo-request'
  ssh:
    proto: 'tcp'
    port: 22
  rsh:
    proto: 'tcp'
    port: 22,23

chains:
  filter:
    test1:
      - 'accept from net1 to any service http'
      - 'accept from host1,host2 to net1,net2 service http,ssh'
      - 'accept from net3 service rsh'

rules:
  # syntax is table_chain
  # if table is omitted: filter
  filter input:
    from mgt:
      # accept state established (free)
      - 'accept service ssh'
      - 'log_reject'
    #to mgt:
    #  - 'accept'
  filter forward:
    # creates chain forward-mgt-to-sup
    from mgt to sup:
      # accept state established
      # clampmss
      - 'accept'
    from mgt to pub:
      - 'accept'
    from pub to mgt:
      - 'accept state established'
      - 'jump test1'
    default:
      # accept state established
      # clampmss
      - 'reject'
      #- 'log, reject'
  nat postrouting:
    to pub:
      - 'masquerade from net2'
